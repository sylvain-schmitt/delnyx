{% extends 'layout/base.html.twig' %}

{% block title %}Prendre rendez-vous - Delnyx
{% endblock %}

{% block body %}
	<div class="min-h-screen bg-slate-950 py-20 px-4">
		<div class="max-w-5xl mx-auto" style="margin-top: 150px;">
			<div class="text-center mb-12">
				<h1 class="text-4xl font-bold text-white mb-4">Prendre rendez-vous</h1>
				<p class="text-slate-400">Choisissez un créneau disponible pour discuter de votre projet.</p>
			</div>

			<div
				class="grid grid-cols-1 lg:grid-cols-3 gap-8">
				{# Calendrier Visuel #}
				<div class="lg:col-span-1 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-8">
					<div
						data-controller="calendar" data-calendar-selected-date-value="{{ date|date('Y-m-d') }}" data-calendar-booking-url-value="{{ path('public_booking') }}">
						{# En-tête du calendrier #}
						<div class="flex items-center justify-between mb-4">
							<button type="button" data-calendar-target="prev" data-action="click->calendar#previousMonth" class="w-8 h-8 flex items-center justify-center rounded-lg bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white transition-all">
								{{ ux_icon('lucide:chevron-left', {class: 'w-5 h-5'}) }}
							</button>
							<h2 data-calendar-target="month" class="text-lg font-semibold text-white"></h2>
							<button type="button" data-calendar-target="next" data-action="click->calendar#nextMonth" class="w-8 h-8 flex items-center justify-center rounded-lg bg-white/5 hover:bg-white/10 text-slate-400 hover:text-white transition-all">
								{{ ux_icon('lucide:chevron-right', {class: 'w-5 h-5'}) }}
							</button>
						</div>

						{# Jours de la semaine #}
						<div class="grid grid-cols-7 gap-1 mb-2">
							<div class="text-center text-xs font-medium text-slate-500 py-1">Lu</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Ma</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Me</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Je</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Ve</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Sa</div>
							<div class="text-center text-xs font-medium text-slate-500 py-1">Di</div>
						</div>

						{# Grille des jours (générée par JS) #}
						<div data-calendar-target="grid" class="grid grid-cols-7" style="gap: 8px; justify-items: center;"></div>

						{# Légende #}
						<div class="mt-4 pt-4 border-t border-white/5 flex flex-wrap gap-3 text-xs text-slate-500">
							<div class="flex items-center gap-1">
								<div class="w-3 h-3 rounded bg-blue-600"></div>
								<span>Sélectionné</span>
							</div>
							<div class="flex items-center gap-1">
								<div class="w-3 h-3 rounded bg-cyan-500/30 border border-cyan-500/50"></div>
								<span>Aujourd'hui</span>
							</div>
						</div>
					</div>
				</div>

				{# Créneaux #}
				<div class="lg:col-span-2 bg-white/5 backdrop-blur-xl border border-white/10 rounded-2xl p-6">
					<h2 class="text-lg font-semibold text-white mb-6">Disponibilités pour le
						{{ dateLabel }}</h2>

					{% if slots is empty %}
						<div class="text-center py-12">
							<div class="w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-500">
								<i class="lucide-calendar-x w-8 h-8"></i>
							</div>
							<p class="text-slate-400">Aucun créneau disponible pour cette date.</p>
							<p class="text-xs text-slate-500 mt-1">Essayez de sélectionner une autre journée.</p>
						</div>
					{% else %}
						<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
							{% for slot in slots %}
								<a href="{{ path('public_booking_confirm', {start: slot.start|date('Y-m-d H:i:s'), end: slot.end|date('Y-m-d H:i:s')}) }}" class="p-4 bg-white/5 border border-white/10 rounded-xl text-center group hover:bg-blue-600/10 hover:border-blue-500/50 transition-all">
									<span class="block text-white font-bold group-hover:text-blue-400">{{ slot.start|date('H:i') }}</span>
									<span class="text-[10px] text-slate-500 uppercase tracking-wider">30 min</span>
								</a>
							{% endfor %}
						</div>
					{% endif %}

					<div class="mt-8 pt-6 border-t border-white/5">
						<p class="text-xs text-slate-500 italic">
							* Les horaires sont affichés sur le fuseau horaire de Paris (UTC+1).
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
