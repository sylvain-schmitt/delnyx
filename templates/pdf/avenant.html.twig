{% extends 'pdf/base.html.twig' %}

{% block content %}
	<!-- En-tête -->
	<div class="header">
		<div class="company-info">
			<div class="company-logo">
				{% if logo_base64 %}
					<img src="{{ logo_base64 }}" alt="DELNYX" style="height: 40px; width: auto;">
				{% else %}
					<span style="font-size: 24px; font-weight: bold; color: #2563eb; letter-spacing: 2px;">DELNYX</span>
				{% endif %}
			</div>
			<div class="company-details">
				<strong>Développement Web & Applications</strong><br>
				Sylvain SCHMITT<br>
				Micro-entrepreneur<br>
				SIRET: 12345678901234<br>
				Email: contact@delnyx.fr<br>
				Tél: +33 6 XX XX XX XX
			</div>
		</div>
		<div class="document-info">
			<div class="document-title">AVENANT</div>
			<div class="document-number">{{ avenant.numero }}</div>
			<div class="document-date">
				Créé le {{ avenant.dateCreation|date('d/m/Y') }}<br>
				{% if avenant.dateValidation %}
					Validé le {{ avenant.dateValidation|date('d/m/Y') }}
				{% endif %}
			</div>
		</div>
	</div>

	<!-- Informations client -->
	<div class="client-section">
		<div class="client-info">
			<div class="section-title">Client</div>
			{% if avenant.devis %}
				<div class="client-name">{{ avenant.devis.client.nomComplet }}</div>
				<div class="client-details">
					{% if avenant.devis.client.email %}
						{{ avenant.devis.client.email }}<br>
					{% endif %}
					{% if avenant.devis.client.telephone %}
						{{ avenant.devis.client.telephone }}<br>
					{% endif %}
					{% if avenant.devis.client.adresse %}
						{{ avenant.devis.client.adresse }}<br>
						{% if avenant.devis.client.codePostal %}
							{{ avenant.devis.client.codePostal }}
						{% endif %}
						{% if avenant.devis.client.ville %}
							{{ avenant.devis.client.ville }}
						{% endif %}
					{% endif %}
					{% if avenant.devis.client.siret %}<br>SIRET:
						{{ avenant.devis.client.siret }}
					{% endif %}
				</div>
			{% else %}
				<div class="client-name">Client non défini</div>
			{% endif %}
		</div>
	</div>

	<!-- Informations du devis d'origine -->
	<div class="original-document-section">
		<div class="section-title">Devis d'origine</div>
		{% if avenant.devis %}
			<div class="document-details">
				<strong>Numéro :</strong> {{ avenant.devis.numero }}<br>
				<strong>Date de création :</strong> {{ avenant.devis.dateCreation|date('d/m/Y') }}<br>
				<strong>Montant TTC :</strong> {{ avenant.devis.getMontantTTCFormate() }}
			</div>

			{% if avenant.devis.tarifs|length > 0 %}
				<div class="tarifs-section" style="margin-top: 8px;">
					<div class="section-title">Tarifs du devis d'origine</div>
					<table class="tarifs-table">
						<thead>
							<tr>
								<th>Prestation</th>
								<th>Description</th>
								<th>Prix</th>
							</tr>
						</thead>
						<tbody>
							{% for tarif in avenant.devis.tarifs %}
								<tr>
									<td>{{ tarif.nom }}</td>
									<td>{{ tarif.description }}</td>
									<td>{{ tarif.getPrixTTCFormate() }}</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			{% endif %}
		{% endif %}
	</div>

	<!-- Tarifs de l'avenant -->
	{% if avenant.tarifs|length > 0 %}
		<div class="tarifs-section">
			<div class="section-title">Tarifs de l'avenant</div>
			<table class="tarifs-table">
				<thead>
					<tr>
						<th>Prestation</th>
						<th>Description</th>
						<th>Prix</th>
					</tr>
				</thead>
				<tbody>
					{% for tarif in avenant.tarifs %}
						<tr>
							<td>{{ tarif.nom }}</td>
							<td>{{ tarif.description }}</td>
							<td>{{ tarif.getPrixTTCFormate() }}</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	{% endif %}

	<!-- Motif et modifications -->
	<div class="modifications-section">
		<div class="section-title">Motif de la modification</div>
		<div class="content-box">
			{{ avenant.motif|nl2br }}
		</div>

		<div class="section-title">Modifications apportées</div>
		<div class="content-box">
			{{ avenant.modifications|nl2br }}
		</div>

		{% if avenant.justification %}
			<div class="section-title">Justification</div>
			<div class="content-box">
				{{ avenant.justification|nl2br }}
			</div>
		{% endif %}
	</div>

	<!-- Résumé financier de l'avenant -->
	<div class="summary-section">
		<div class="section-title">Résumé financier de l'avenant</div>
		<table class="summary-table">
			<tr>
				<td><strong>Montant HT :</strong></td>
				<td>{{ avenant.getMontantHTFormate() }}</td>
			</tr>
			<tr>
				<td><strong>TVA ({{ avenant.tauxTVA }}%) :</strong></td>
				<td>{{ avenant.getMontantTVAFormate() }}</td>
			</tr>
			<tr class="total-row">
				<td><strong>Montant TTC :</strong></td>
				<td><strong>{{ avenant.getMontantTTCFormate() }}</strong></td>
			</tr>
		</table>
	</div>

	<!-- Notes -->
	{% if avenant.notes %}
		<div class="notes-section">
			<div class="section-title">Notes</div>
			<div class="content-box">
				{{ avenant.notes|nl2br }}
			</div>
		</div>
	{% endif %}

	<!-- Mentions légales -->
	<div class="legal-section">
		<div class="section-title">Mentions légales</div>
		<div class="legal-text">
			<p><strong>Important :</strong> Cet avenant modifie le devis {{ avenant.devis.numero }} du {{ avenant.devis.dateCreation|date('d/m/Y') }}. 
			Le devis d'origine reste valide et inchangé. Cet avenant constitue un document complémentaire légal.</p>
			
			<p>En cas d'acceptation de cet avenant, les nouvelles conditions s'appliquent en complément du devis d'origine.</p>
			
			<p><strong>Validité :</strong> Cet avenant est valable 30 jours à compter de sa date de création.</p>
		</div>
	</div>

	<!-- Pied de page -->
	<div class="footer">
		<div class="footer-content">
			<p><strong>DELNYX</strong> - Développement Web & Applications</p>
			<p>Micro-entrepreneur - SIRET: 12345678901234</p>
			<p>Email: contact@delnyx.fr - Tél: +33 6 XX XX XX XX</p>
		</div>
	</div>
{% endblock %}