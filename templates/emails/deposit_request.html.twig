{% extends 'emails/layout/base.html.twig' %}

{% block body %}
	<p>Bonjour
		{{ client.prenom ?? 'Cher client' }},</p>

	<p>Merci d'avoir signé le devis
		<strong>{{ quote.numero }}</strong>.</p>

	<p>Conformément aux conditions convenues, nous vous demandons de régler l'accompte suivant :</p>

	<div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0; text-align: center;">
		<p style="margin: 0; font-size: 14px; color: #666;">Montant de l'accompte</p>
		<p style="margin: 10px 0; font-size: 28px; font-weight: bold; color: #1a1a1a;">{{ deposit.formattedAmount }}</p>
		<p style="margin: 0; font-size: 14px; color: #666;">soit
			{{ deposit.percentage|number_format(0) }}% du total TTC</p>
	</div>

	<div style="text-align: center; margin: 30px 0;">
		<a href="{{ paymentUrl }}" style="display: inline-block; padding: 14px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 16px;">
			Payer l'accompte en ligne
		</a>
	</div>

	<p style="color: #666; font-size: 14px;">
		Ce paiement sécurisé est traité par Stripe. Vous recevrez une confirmation par email une fois le paiement effectué.
	</p>

	<hr style="border: none; border-top: 1px solid #eee; margin: 30px 0;">

	<p style="font-size: 14px; color: #666;">
		<strong>Récapitulatif du devis :</strong><br>
		Montant total TTC :
		{{ quote.montantTTCFormate }}<br>
		{% if quote.totalPaidDeposits > 0 %}
			Acomptes déjà réglés : <span style="color: #059669;">- {{ quote.totalPaidDepositsFormatted }}</span><br>
		{% endif %}
		Accompte demandé :
		{{ deposit.formattedAmount }}<br>
		<strong>Solde restant après ce paiement :</strong>
		<span style="color: #1e293b; font-weight: bold;">{{ quote.balanceAfterDepositFormatted(deposit) }}</span>
	</p>

	<p>Cordialement,</p>
{% endblock %}
