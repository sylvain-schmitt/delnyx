{% extends 'emails/layout/base.html.twig' %}

{% block body %}
    <h1>Votre devis est prÃªt</h1>

    <p>Bonjour {{ client.nomComplet }},</p>

    {% if customMessage %}
        <div class="custom-message">
            {{ customMessage|nl2br }}
        </div>
    {% else %}
        <p>Nous avons le plaisir de vous transmettre votre devis.</p>
    {% endif %}

    <div class="info-box">
        <p><strong>NumÃ©ro de devis :</strong> {{ quote.numero }}</p>
        <p><strong>Date :</strong> {{ quote.dateCreation|date('d/m/Y') }}</p>
        {% if quote.dateValidite %}
            <p><strong>Valide jusqu'au :</strong> {{ quote.dateValidite|date('d/m/Y') }}</p>
        {% endif %}
        <p><strong>Montant TTC :</strong> <span style="font-size: 18px; color: #1e293b;">{{ quote.montantTTCFormate }}</span></p>

        {% if quote.acomptePourcentage > 0 %}
            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed #e5e7eb;">
                <p style="color: #059669; margin-bottom: 5px;"><strong>ğŸ’° Conditions de paiement :</strong></p>
                <p style="margin: 3px 0;">â€¢ Acompte de {{ quote.acomptePourcentage|number_format(0) }}% Ã  la signature : <strong>{{ quote.acompteFormatted }}</strong></p>
                <p style="margin: 3px 0;">â€¢ Solde de {{ (100 - quote.acomptePourcentage)|number_format(0) }}% Ã  la livraison : <strong>{{ quote.soldeApresAcompteFormatted }}</strong></p>
            </div>
        {% endif %}
    </div>

    {# Boutons d'action avec magic links #}
    <div style="text-align: center; margin: 30px 0;">
        <a href="{{ magic_link(quote, 'view') }}" style="display: inline-block; padding: 12px 24px; background-color: #3b82f6; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; margin: 5px;">
            ğŸ‘ï¸ Voir le devis
        </a>
        {% if quote.statut.value in ['issued', 'sent'] %}
            <a href="{{ magic_link(quote, 'sign') }}" style="display: inline-block; padding: 12px 24px; background-color: #22c55e; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; margin: 5px;">
                âœ… Signer le devis
            </a>
        {% endif %}
    </div>

    <div style="background-color: #f0f9ff; border-left: 4px solid #3b82f6; padding: 15px; margin: 30px 0;">
        <p style="margin: 0; color: #1e40af;">
            ğŸ“ <strong>Le devis complet est Ã©galement disponible en piÃ¨ce jointe (PDF).</strong>
        </p>
    </div>

    <p>Pour toute question concernant ce devis, n'hÃ©sitez pas Ã  nous contacter.</p>

    <p style="margin-top: 30px;">
        Cordialement,<br>
        <strong>L'Ã©quipe Delnyx</strong>
    </p>
{% endblock %}


